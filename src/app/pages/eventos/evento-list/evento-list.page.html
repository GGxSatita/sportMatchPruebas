<app-header></app-header>

<ion-content class="ion-padding">
  <ion-fab slot="fixed" vertical="top" horizontal="start">
    <ion-fab-button>
      <ion-icon name="chevron-forward-circle"></ion-icon>
    </ion-fab-button>
    <ion-fab-list side="end">
      <ion-fab-button (click)="navigateTo('evento-alumno')" color="primary">
        <ion-icon name="calendar" color="light"></ion-icon>
      </ion-fab-button>
      <ion-fab-button (click)="navigateTo('evento-add')"color="primary">
        <ion-icon name="add" color="light"></ion-icon>
      </ion-fab-button>
    </ion-fab-list>
  </ion-fab>

  <ion-grid>

    <br><br>

    <ion-row>
      <ion-col size="12">
        <ion-list>
          <ng-container *ngFor="let evento of eventosFiltrados">
            <ion-card>
              <ion-grid>
                <ion-row>
                  <ion-col size="12" class="ion-text-center">
                    <ion-card-header>
                      <ion-card-title>{{ evento.titulo }}</ion-card-title>
                    </ion-card-header>
                    <p>{{ evento.descripcion }}</p>
                  </ion-col>
                </ion-row>

                <ion-row *ngIf="selectedSectorImage">
                  <ion-col size="12">
                    <img [src]="selectedSectorImage" alt="Imagen del sector"
                      style="width: 100%; height: auto; border-radius: 8px;" />
                  </ion-col>
                </ion-row>

                <ion-row>
                  <ion-col size="12" class="ion-text-center">
                    <ion-button fill="clear" (click)="toggleEventoExpandido(evento.idEventosAlumnos)">
                      <ion-icon slot="start"
                        [name]="eventosExpandido[evento.idEventosAlumnos] ? 'chevron-up-circle' : 'chevron-down-circle'">
                      </ion-icon>
                      {{ eventosExpandido[evento.idEventosAlumnos] ? 'Menos Información' : 'Más Información' }}
                    </ion-button>
                  </ion-col>
                </ion-row>

                <div *ngIf="eventosExpandido[evento.idEventosAlumnos]" style="margin-top: 10px;">
                  <ion-grid>
                    <ion-row class="evento-info-row">
                      <ion-col size="4"><ion-label color="primary"><strong>Sector:</strong></ion-label></ion-col>
                      <ion-col size="8"><p>{{ evento.sectorNombre }}</p></ion-col>
                    </ion-row>
                    <ion-row class="evento-info-row">
                      <ion-col size="4"><ion-label color="primary"><strong>Fecha:</strong></ion-label></ion-col>
                      <ion-col size="8"><p>{{ evento.fechaReservada }}</p></ion-col>
                    </ion-row>
                    <ion-row class="evento-info-row">
                      <ion-col size="4"><ion-label color="primary"><strong>Hora:</strong></ion-label></ion-col>
                      <ion-col size="8"><p>{{ evento.hora }}</p></ion-col>
                    </ion-row>
                    <ion-row class="evento-info-row">
                      <ion-col size="4"><ion-label color="primary"><strong>Capacidad:</strong></ion-label></ion-col>
                      <ion-col size="8">
                        <p>{{ evento.participantesActuales?.length || 0 }} / {{ evento.capacidadMaxima }}</p>
                      </ion-col>
                    </ion-row>
                  </ion-grid>

                  <ion-row>
                    <ion-col size="12" class="ion-text-center">
                      <ion-button color="primary"
                        (click)="inscribirseEnEvento(evento)"
                        [disabled]="
                          (evento.participantesActuales?.length || 0) >= evento.capacidadMaxima ||
                          evento.idAlumno === idAlumno ||
                          evento.participantesActuales?.includes(idAlumno)">
                        Inscribirse
                      </ion-button>
                    </ion-col>
                  </ion-row>
                </div>
              </ion-grid>
            </ion-card>
          </ng-container>
        </ion-list>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>

<app-footer></app-footer>
